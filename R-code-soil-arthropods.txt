library(xlsx)
library(glmulti)
glmulti_vegsfall_abundance1 <- glmulti(veg_fall2016_GLMsource$Arthropod_abundance~veg_fall2016_GLMsource$TRI+veg_fall2016_GLMsource$Min_dis_forest+veg_fall2016_GLMsource$Elevation+veg_fall2016_GLMsource$Slope+veg_fall2016_GLMsource$Canopy_density+factor(veg_fall2016_GLMsource$Leaf_litter)+veg_fall2016_GLMsource$Trees_abundance+veg_fall2016_GLMsource$Trees_richness+veg_fall2016_GLMsource$Herbs_abundance+veg_fall2016_GLMsource$Herbs_richness+veg_fall2016_GLMsource$Grass_cover_perc,level=1,family="poisson")
summary(glmulti_vegsfall_abundance1@objectplot(glmulti_vegsfall_abundance1,type="s")
glmulti_vegsfall_richness1 <- glmulti(veg_fall2016_GLMsource$Arthropod_richness~veg_fall2016_GLMsource$TRI+veg_fall2016_GLMsource$Min_dis_forest+veg_fall2016_GLMsource$Elevation+veg_fall2016_GLMsource$Slope+veg_fall2016_GLMsource$Canopy_density+factor(veg_fall2016_GLMsource$Leaf_litter)+veg_fall2016_GLMsource$Trees_abundance+veg_fall2016_GLMsource$Trees_richness+veg_fall2016_GLMsource$Herbs_abundance+veg_fall2016_GLMsource$Herbs_richness+veg_fall2016_GLMsource$Grass_cover_perc,level=1,family="poisson")
summary(glmulti_vegsfall_richness1@objects[[1]])
plot(glmulti_vegsfall_richness1,type="s")
glmulti(veg_summer2016_GLMsource$Arthropod_abundance~veg_summer2016_GLMsource$TRI+veg_summer2016_GLMsource$Min_dis_forest+veg_summer2016_GLMsource$Elevation+veg_summer2016_GLMsource$Slope+veg_summer2016_GLMsource$Canopy_density+factor(veg_summer2016_GLMsource$Leaf_litter)+veg_summer2016_GLMsource$Trees_abundance+veg_summer2016_GLMsource$Trees_richness+veg_summer2016_GLMsource$Herbs_abundance+veg_summer2016_GLMsource$Herbs_richness+veg_summer2016_GLMsource$Grass_cover_perc,level=1,family="poisson") -> glmulti_vegsummer_abundance1
summary(glmulti_vegsummer_abundance1@objects[[1]])
plot(glmulti_vegsummer_abundance1,type="s")
glmulti(veg_summer2016_GLMsource$Arthropod_richness~veg_summer2016_GLMsource$TRI+veg_summer2016_GLMsource$Min_dis_forest+veg_summer2016_GLMsource$Elevation+veg_summer2016_GLMsource$Slope+veg_summer2016_GLMsource$Canopy_density+factor(veg_summer2016_GLMsource$Leaf_litter)+veg_summer2016_GLMsource$Trees_abundance+veg_summer2016_GLMsource$Trees_richness+veg_summer2016_GLMsource$Herbs_abundance+veg_summer2016_GLMsource$Herbs_richness+veg_summer2016_GLMsource$Grass_cover_perc,level=1,family="poisson") -> glmulti_vegsummer_richness1
summary(glmulti_vegsummer_richness1@objects[[1]])
plot(glmulti_vegsummer_richness1,type="s")
glmulti(soildata$Richness~soildata$pH+soildata$Org_C+soildata$Min_N+soildata$Extra_P+soildata$Exch_K+soildata$pH:soildata$Org_C+soildata$pH:soildata$Min_N+soildata$pH:soildata$Extra_P+soildata$pH:soildata$Exch_K ,level=2, family = "poisson") -> soil_glmultiR_pH_interact
summary(soil_glmultiR_pH_interact@objects[[1]])
plot(soil_glmultiR_pH_interact,type="s")
summary(soil_glmulti1@objects[[1]])
soildata_conventional <- subset(soildata, soildata$Site != "JUNGPANA" & soildata$Site != "MAJUA" & soildata$Site != "PUSSIMBING" & soildata$Site != "MIMORG" & soildata$Site != "THAM" & soildata$Site != "MIRIK BUSTY" & soildata$Site != "SEYOK")
soildata_organic <- subset(soildata, soildata$Site == "JUNGPANA" | soildata$Site == "MAJUA" | soildata$Site == "PUSSIMBING" | soildata$Site == "MIMORG" | soildata$Site == "THAM" | soildata$Site == "MIRIK BUSTY" | soildata$Site == "SEYOK")
wilcox.test(soildata_organic$pH,soildata_conventional$pH)
wilcox.test(soildata_organic$Org_C,soildata_conventional$Org_C)
wilcox.test(soildata_organic$Min_N,soildata_conventional$Min_N)
wilcox.test(soildata_organic$Extra_P,soildata_conventional$Extra_P)
wilcox.test(soildata_organic$Exch_K,soildata_conventional$Exch_K)

NMDS_order_summer <- data.frame(NMDS_order_summer)
NMDS <- metaMDS(NMDS_order_summer)
stressplot(NMDS)
ordiplot(NMDS,type="n")
orditorp(NMDS,display="sites",cex=1.25, air=0.1)
orditorp(NMDS,display="species",col="red",air=0.01)
ordihull(NMDS, groups = treat,draw="polygon",col="grey90",label=F)
treat <- rownames(NMDS_order_summer)
NMDS2 <- metaMDS(NMDS_order_summer_2)
read.xlsx("NMDS_order.xlsx",2) -> NMDS_order_summer_2
stressplot(NMDS2)
orditorp(NMDS2,display="sites",cex=1.25, air=0.1)
ordihull(NMDS2, groups = treat,draw="polygon",col="grey90",label=F)
orditorp(NMDS2,display="species",col="red",air=0.01)
library(xlsx)
NMDS_order_AS <- read.xlsx("NMDS_order.xlsx",5)
rownames(NMDS_order_AS) <- NMDS_order_AS$Site.names
NMDS_order_AS$Site.names <- NULL
library(vegan)
NMDS_AS <- metaMDS(NMDS_order_AS)
stressplot(NMDS_AS)
AS <- read.xlsx("NMDS_order.xlsx",6)
factor_season <- factor(AS$Season)
factor_estate <- factor(AS$Estate)
pchs <- c(0:5)
col.gr <- c("red","blue")
plot(NMDS_AS,type="n",display="sites")
points(NMDS_AS,display="sites",pch = pchs[factor_estate],col=col.gr[factor_season],cex=0.7)
Treat_AS_MB <- c(1:2,rep("Summer Mirik Busty",each=5),3:26,rep("Autumn Mirik Busty",each=5),27:48)
ordihull(NMDS_AS,groups=Treat_AS_MB,draw="polygon",col="grey90",label=F)
Treat_AS_MD <- c(rep("Summer Mahal Diram",each=2),1:27,rep("Autumn Mahal Diram",each=2),28:54)
ordihull(NMDS_AS,groups=Treat_AS_MD,draw="polygon",col="grey90",label=F)
Treat_AS_MH <- c(1:7,rep("Summer Margaret's Hope",each=4),8:32,rep("Autumn Margaret's Hope",each=4),33:50)ordihull(NMDS_AS,groups=Treat_AS_MH,draw="polygon",col="grey90",label=F)
read.xlsx("Dunn_test_certification+management.xlsx",1) -> cert_management
kruskal.test(veg_summer2016$Trees_abundance~veg_summer2016$Estate)
kruskal.test(veg_summer2016$Elevation~veg_summer2016$Estate)
kruskal.test(veg_summer2016$Canopy_density...~veg_summer2016$Estate)
dunn.test(veg_summer2016$Canopy_density...,g=veg_summer2016$Estate,method='bonferroni')
dunn.test(veg_fall2016$Min_dis_forest,g=veg_fall2016$Estate.Name,method='bonferroni')
dunn.test(veg_fall2016$Vegetation_ENoS,g=veg_fall2016$Estate.Name,method='bonferroni')
dunn.test(veg_fall2016$Vegetation_abundance,g=veg_fall2016$Estate.Name,method='bonferroni')
dunn.test(veg_fall2016$Vegetation_richness,g=veg_fall2016$Estate.Name,method='bonferroni')
dunn.test(veg_fall2016$Herbs_ENoS,g=veg_fall2016$Estate.Name,method='bonferroni')
dunn.test(veg_fall2016$Herbs_richness,g=veg_fall2016$Estate.Name,method='bonferroni')
dunn.test(veg_fall2016$Herbs_abundance,g=veg_fall2016$Estate.Name,method='bonferroni')
dunn.test(veg_fall2016$Leaf_litter,g=veg_fall2016$Estate.Name,method='bonferroni')
dunn.test(veg_fall2016$Canopy.density,g=veg_fall2016$Estate.Name,method='bonferroni')
dunn.test(veg_fall2016$Aspect,g=veg_fall2016$Estate.Name,method='bonferroni')
glmulti(Abundance~pH+Org.C+Min.N+Extra.P+Exch.K, data=soildata_autumn,family = 'poisson',level=1) -> soil_glmulti_autumn_A
summary(soil_glmulti_autumn_A@objects[[1]])
glmulti(Richness~pH+Org.C+Min.N+Extra.P+Exch.K, data=soildata_autumn,family = 'poisson',level=1) -> soil_glmulti_autumn_R
summary(soil_glmulti_autumn_R@objects[[1]])
read.xlsx("veg_summer2016_latlong.xlsx",1) -> veg_summer2016_TRI
read.xlsx("veg_fall2016_latlong.xlsx",1) -> veg_fall2016_TRI
veg_fall2016[2] <- veg_fall2016_TRI[3]
colnames(veg_fall2016)[2] <- "TRI"
veg_fall2016[23] <- veg_fall2016_TRI[1]
veg_fall2016[24] <- veg_fall2016_TRI[2]
veg_fall2016_GLMsource[13] <- veg_fall2016[2]
cor(veg_fall2016_GLMsource,method="pearson") -> pearson_veg_fall
veg_summer2016_TRI <- read.xlsx("veg_summer2016_TRI.xlsx",1)
veg_summer2016_TRI
veg_summer2016[2] <- veg_summer2016_TRI[3]
veg_summer2016_GLMsource[13] <- veg_summer2016[2]
cor(veg_summer2016,method = "pearson") -> pearson_veg_summer
glmulti_vegsummer_abundance1_interaction11 <- glm(data = veg_summer2016_GLMsource, Arthropod_abundance~as.factor(Leaf_litter)+Min_dis_forest+Slope+Elevation+Trees_abundance+Trees_richness+Grass_cover_perc+as.factor(Leaf_litter):Trees_abundance + Trees_abundance:Elevation+Herbs_abundance:Elevation+TRI:Trees_abundance+Trees_richness:TRI,family="poisson")
library(glmmML)
GLMMLboot_richness <- glmmboot(Arthropod_richness~Min_dis_forest+Elevation+Slope+Canopy_density+Leaf_litter+Trees_abundance+Trees_richness+Herbs_abundance+Herbs_richness+Grass_cover_perc+TRI, data=veg_GLMMLboot_source, cluster = factor(season), boot = 5000, family = "poisson")
summary(GLMMLboot_richness)
GLMMLboot_abundance <- glmmboot(Arthropod_abundance~Min_dis_forest+Elevation+Slope+Canopy_density+Leaf_litter+Trees_abundance+Trees_richness+Herbs_abundance+Herbs_richness+Grass_cover_perc+TRI, data=veg_GLMMLboot_source, cluster = factor(season), boot = 5000, family = "poisson")
summary(GLMMLboot_abundance)
lm_FE_abundance <- lm(Arthropod_abundance~Min_dis_forest+Elevation+Slope+Canopy_density+Leaf_litter+Trees_abundance+Trees_richness+Herbs_abundance+Herbs_richness+Grass_cover_perc+TRI+season, data=veg_GLMMLboot_source)
read.xlsx("summer_withsoil.xlsx",3) -> summer_withsoil
cor(summer_withsoil,method="pearson") -> summer_withsoil_pearson
glm_summer_abundance_nullmodel <- glm(Arthropod_abundance~Min_dis_forest+Elevation+TRI+Slope+Canopy_density...+Leaf_litter+Trees_richness+Trees_abundance+Herbs_richness+Herbs_abundance+Grass_cover_perc+pH+Org_C+Min_N+Extra_P+Exch_K, data=summer_withsoil_GLMsource,family="poisson")
summary(glm_summer_abundance_nullmodel)
summer_withsoil_GLMsource$Trees_abundance <- NULL
summer_withsoil_GLMsource$Herbs_richness <- NULL
summer_withsoil_GLMsource$Exch_K <- NULL
glm_summer_abundance_nullmodel <- glm(Arthropod_abundance~Min_dis_forest+Elevation+TRI+Canopy_density...+as.factor(Leaf_litter)+Trees_richness+Herbs_abundance+Grass_cover_perc+pH+Org_C+Min_N+Extra_P, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_abundance_geoparameters1 <- glm(Arthropod_abundance~Min_dis_forest+Elevation+TRI, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_abundance_vegparameters1 <- glm(Arthropod_abundance~Canopy_density...+as.factor(Leaf_litter)+Trees_richness+Herbs_abundance+Grass_cover_perc, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_abundance_soilparameters1 <- glm(Arthropod_abundance~pH+Org_C+Min_N+Extra_P, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_nullmodel <- glm(Arthropod_richness~Min_dis_forest+Elevation+TRI+Canopy_density...+as.factor(Leaf_litter)+Trees_richness+Herbs_abundance+Grass_cover_perc+pH+Org_C+Min_N+Extra_P, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_geoparameters1 <- glm(Arthropod_richness~Min_dis_forest+Elevation+TRI, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_vegparameters2 <- glm(Arthropod_richness~Canopy_density...+Trees_richness+Herbs_abundance, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_nullmodel2 <- glm(Arthropod_richness~Min_dis_forest+Elevation+Canopy_density...+Trees_richness+Grass_cover_perc+pH+Org_C+Min_N+Extra_P, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_soilparameters1 <- glm(Arthropod_richness~pH+Org_C+Min_N+Extra_P, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_soilparameters2 <- glm(Arthropod_richness~pH+Org_C+Extra_P, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_soilparameters3 <- glm(Arthropod_richness~pH+Org_C, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_vegparameters3 <- glm(Arthropod_richness~Canopy_density...+Trees_richness, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_geoparameters2 <- glm(Arthropod_richness~Min_dis_forest+Elevation, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_geo_veg1 <- glm(Arthropod_richness~Min_dis_forest+Elevation+Canopy_density...+Trees_richness, data=summer_withsoil_GLMsource,family="poisson")
glm_summer_richness_nullmodel3 <- glm(Arthropod_richness~Min_dis_forest+Elevation+Canopy_density...+Trees_richness+Grass_cover_perc+pH+Org_C, data=summer_withsoil_GLMsource,family="poisson")
cor(fall_withsoil,method="pearson") -> fall_withsoil_pearson
read.xlsx("GLM's Jan-18/fall_withsoil.xlsx",3) -> fall_withsoil
glm_fall_abundance_nullmodel1 <- glm(Arthropod_abundance~Min_dis_forest+TRI+Elevation+Slope+Canopy.density+Trees_richness+Trees_abundance+Herbs_abundance+Herbs_richness+Grass_cover_perc+pH+Org.C+Min.N+Extra.P+Exch.K, data=fall_withsoil_GLMsource,family="poisson")
glm_fall_abundance_nullmodel2 <- glm(Arthropod_abundance~TRI+Elevation+Slope+Trees_richness+Herbs_richness+pH+Org.C+Min.N, data=fall_withsoil_GLMsource,family="poisson")
glm_fall_abundance_geoparameters1 <- glm(Arthropod_abundance~TRI+Elevation+Slope, data=fall_withsoil_GLMsource,family="poisson")
glm_fall_abundance_vegparameters1 <- glm(Arthropod_abundance~Trees_richness+Herbs_richness, data=fall_withsoil_GLMsource,family="poisson")
glm_fall_richness_nullmodel1 <- glm(Arthropod_richness~Min_dis_forest+TRI+Elevation+Slope+Canopy.density+Trees_richness+Trees_abundance+Herbs_abundance+Herbs_richness+Grass_cover_perc+pH+Org.C+Min.N+Extra.P+Exch.K, data=fall_withsoil_GLMsource,family="poisson")
glm_fall_richness_nullmodel2 <- glm(Arthropod_richness~TRI+Slope+Trees_richness+Trees_abundance+Min.N+Extra.P, data=fall_withsoil_GLMsource,family="poisson")
glm_fall_richness_nullmodel3 <- glm(Arthropod_richness~TRI+Slope+Trees_richness+Extra.P, data=fall_withsoil_GLMsource,family="poisson")
glm_fall_richness_geoparameters1 <- glm(Arthropod_richness~TRI+Slope, data=fall_withsoil_GLMsource,family="poisson")
glm_fall_richness_vegparameters1 <- glm(Arthropod_richness~Trees_richness, data=fall_withsoil_GLMsource,family="poisson")
glm_fall_richness_soilparameters1 <- glm(Arthropod_richness~Extra.P, data=fall_withsoil_GLMsource,family="poisson")
glm_both_abundance_nullmodel1 <- glm(Arthropod_richness~Min_dis_forest+TRI+as.factor(Leaf_litter)+Elevation+Slope+Canopy_density+Trees_richness+Trees_abundance+Herbs_abundance+Herbs_richness+Grass_cover_perc+pH+Org_C+Min_N+Extra_P+Exch_K+as.factor(Season), data=bothseasons_withsoil,family="poisson")
summary(glm_summer_abundance_geoparameters1)
summary(glm_summer_abundance_vegparameters1)
summary(glm_summer_abundance_soilparameters1)
summary(glm_summer_richness_nullmodel)
summary(glm_summer_richness_geoparameters1)
summary(glm_summer_richness_vegparameters2)
summary(glm_summer_richness_nullmodel2)
summary(glm_summer_richness_soilparameters1)
summary(glm_summer_richness_soilparameters2)
summary(glm_summer_richness_soilparameters3)
summary(glm_summer_richness_vegparameters3)
summary(glm_summer_richness_geoparameters2)
summary(glm_summer_richness_geo_veg1)
summary(glm_summer_richness_nullmodel3)
summary(glm_fall_abundance_nullmodel1)
summary(glm_fall_abundance_nullmodel2)
summary(glm_fall_abundance_geoparameters1)
summary(glm_fall_abundance_vegparameters1)
summary(glm_fall_richness_nullmodel1)
summary(glm_fall_richness_nullmodel2)
summary(glm_fall_richness_nullmodel3)
summary(glm_fall_richness_geoparameters1)
summary(glm_fall_richness_vegparameters1)
summary(glm_fall_richness_soilparameters1)
summary(glm_both_abundance_nullmodel1)
